var utils={isDefined:function(e){return"undefined"!=typeof e&&null!=e},defaultFor:function(e,t){return this.isDefined(e)?e:t},generateRegexForTag:function(e){var t="<"+e+"\\b[^<]*(?:(?!<\\/"+e+">)<[^<]*)*<\\/"+e+"\\s*>";return new RegExp(t,"gi")},generateRegexForEndTag:function(e){var t="<\\/"+e+"\\s*>";return new RegExp(t,"gi")},generateRegexForAttribute:function(e){var t=e+"=(\"|')[^\"']*(\"|')";return new RegExp(t,"gi")}},script_sanitize={utils:utils,sanitize:function(e,t){var r="",i=!0,n=!0,u=["script"],a=["onmouseover"];utils.isDefined(t)&&(r=utils.defaultFor(t.replacementText,r),i=utils.defaultFor(t.loop,i),n=utils.defaultFor(t.removeEndTagsAfter,n),u=utils.defaultFor(t.tags,u),a=utils.defaultFor(t.attributes,a));for(var o in u){var s=u[o],l=utils.generateRegexForTag(s),f=utils.generateRegexForEndTag(s);if(i)for(;l.test(e);)e=e.replace(l,r);else e=e.replace(l,r);if(n)for(;f.test(e);)e=e.replace(f,r)}for(var g in a)for(var d=a[g],p=utils.generateRegexForAttribute(d);p.test(e);)e=e.replace(p,"");return e}};void 0!==typeof module&&(module.exports=script_sanitize);